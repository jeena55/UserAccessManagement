# Security - Firewall
## Introduction

ใน **Linux kernel** มีส่วนประกอบที่เรียกว่า **Netfilter** ซึ่งใช้สำหรับการจัดการหรือตัดสินใจเกี่ยวกับการส่งข้อมูลเครือข่ายเข้าหรือผ่านเซิร์ฟเวอร์ของคุณ โซลูชันไฟร์วอล Linux ทุกตัวใช้ระบบนี้สำหรับการกรองแพ็กเก็ตหากไม่มีอินเตอร์เฟซของผู้ใช้ในพื้นที่การทำงาน ระบบการกรองแพ็กเก็ตของ kernel จะไม่เป็นประโยชน์ต่อผู้ดูแลระบบ และนั่นเป็นเหตุผลที่มี iptables มาช่วยเมื่อแพ็กเก็ตมาถึงที่เซิร์ฟเวอร์ของคุณ มันจะถูกส่งไปยังส่วนประกอบ Netfilter เพื่อตอบรับ การจัดการ หรือปฏิเสธขึ้นอยู่กับกฎที่ได้รับจากพื้นที่ทำงานผู้ใช้ผ่าน iptables ดังนั้น iptables เพียงพอสำหรับการจัดการไฟร์วอลของคุณหากคุณคุ้นเคยกับมัน แต่มีอินเตอร์เฟซหลายรูปแบบที่มีให้ใช้งานเพื่อความง่ายขึ้น

## ufw - Uncomplicated Firewall

เครื่องมือการกำหนดค่าไฟร์วอลที่เริ่มต้นสำหรับ Ubuntu คือ ufw พัฒนาขึ้นเพื่อสะดวกในการกำหนดค่าไฟร์วอล iptables ufw ให้วิธีการใช้งานที่ใช้ง่ายในการสร้างไฟร์วอลเบสเริ่มต้น IPv4 หรือ IPv6โดยปกติ ufw จะถูกปิดใช้งานตั้งแต่เริ่มต้น ตาม ufw man page: "ufw ไม่ได้มีวัตถุประสงค์ที่จะให้ฟังก์ชันไฟร์วอลที่สมบูรณ์ผ่านอินเตอร์เฟซคำสั่งของมัน แต่มีวัตถุประสงค์ในการให้วิธีง่ายๆในการเพิ่มหรือลบกฎที่เรียบง่าย ๆ ปัจจุบันใช้สำหรับไฟร์วอลเบสเริ่มต้น"
##

 **ด้านล่างนี้เป็นตัวอย่างของวิธีการใช้งาน ufw**
 

แนวทางการใช้งาน ufw (Uncomplicated Firewall) เพื่อกำหนดกฎการทำงานของไฟวอลล์ในระบบ Linux โดยใช้คำสั่งต่าง ๆ ตามด้านล่างนี้:

**- เปิดใช้งาน ufw:**

    `sudo ufw enable`
    

 **- เปิดพอร์ต (ตัวอย่างเปิดพอร์ต SSH):**

    `sudo ufw allow 22`

 **- การเพิ่มกฎโดยระบุเลขลำดับ:**

	`sudo ufw insert 1 allow 80` 

 **- ปิดพอร์ตที่เปิดไว้:**

	`sudo ufw deny 22` 

 **- การลบกฎโดยระบุกฎ:**

	`sudo ufw delete deny 22` 

 **- อนุญาตการเข้าถึงจากโฮสต์หรือเครือข่ายที่ระบุ:**

	`sudo ufw allow proto tcp from 192.168.0.2 to any port 22` 

แทนที่ 192.168.0.2 ด้วย 192.168.0.0/24 เพื่ออนุญาตการเข้าถึง SSH จากทั้งเครือข่ายทั้งหมดใน subnet.

**- เพิ่มคำสั่ง --dry-run เพื่อดูกฎที่จะถูกสร้างโดย ufw แต่ไม่นำไปใช้:**

	`sudo ufw --dry-run allow http` 
 **- ปิดใช้งาน ufw:**

	`sudo ufw disable` 

 **- ตรวจสอบสถานะของไฟวอลล์:**

	`sudo ufw status` 

 **- ตรวจสอบสถานะของไฟวอลล์แบบ verbose:**

	`sudo ufw status verbose` 

 **- ดูกฎในรูปแบบเลขลำดับ:**

	`sudo ufw status numbered`

> **Note**
> 
> หากพอร์ตที่คุณต้องการเปิดหรือปิดถูกกำหนดไว้ใน `/etc/services`, คุณสามารถใช้ชื่อพอร์ตแทนตัวเลขได้ ในตัวอย่างข้างต้นนี้ ให้แทน _22_ ด้วย _ssh_.

## 
## ufw Application Integration


แอปพลิเคชันที่เปิดพอร์ตสามารถรวมโปรไฟล์ ufw เข้าไปได้ โดยโปรไฟล์จะระบุพอร์ตที่ต้องการให้แอปพลิเคชันทำงานอย่างถูกต้อง โปรไฟล์ถูกเก็บไว้ที่ `/etc/ufw/applications.d` และสามารถแก้ไขได้หากพอร์ตเริ่มต้นได้รับการเปลี่ยนแปลง

**- เพื่อดูว่าแอปพลิเคชันไหนได้ติดตั้งโปรไฟล์แล้วให้ป้อนคำสั่งต่อไปนี้ในเทอร์มินัล:**

    sudo ufw app list 

**- เหมือนกับการอนุญาตให้ไฟวอลล์ใช้งานพอร์ต การใช้โปรไฟล์แอปพลิเคชันสามารถทำได้โดยป้อน:**

    sudo ufw allow Samba 

**- ยังมีไวยากรณ์เสริมให้ใช้งาน:**

    ufw allow from 192.168.0.0/24 to any app Samba 

> แทน _Samba_ และ _192.168.0.0/24_
> ด้วยโปรไฟล์แอปพลิเคชันที่คุณกำลังใช้และช่วง IP ของเครือข่ายของคุณ

> **Note**
> 
> ไม่จำเป็นต้องระบุ _โปรโตคอล_ สำหรับแอปพลิเคชัน เนื่องจากข้อมูลนั้นระบุในโปรไฟล์ อีกทั้ง _ชื่อแอป_ จะแทน _หมายเลขพอร์ต_

**- เพื่อดูรายละเอียดเกี่ยวกับพอร์ต โปรโตคอล และอื่น ๆ ที่ถูกกำหนดให้ป้อน:**

    sudo ufw app info Samba 

ไม่ใช่ทุกแอปพลิเคชันที่ต้องการเปิดพอร์ตเครือข่ายมาพร้อมกับโปรไฟล์ ufw แต่หากคุณได้ทำโปรไฟล์สำหรับแอปพลิเคชันแล้ว และต้องการให้ไฟล์ถูกรวมในแพ็กเกจ กรุณาแจ้งข้อผิดพลาดที่แพ็กเกจใน Launchpad

    ubuntu-bug nameofpackage







